(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{65778:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return W}});var r=t(85893),i=t(67294),o=t(94654),s=(t(80376),t(39227)),c=t(86396),a=t(25779),d=t(18222),u=t(90169),l=t(96598),m=function(){var n=(0,o.I0)(),e=(0,o.v9)((function(n){return n.post})),t=e.imagePaths,m=e.postAdded,f=(0,i.useRef)(),h=(0,u.Z)(""),p=(0,s.Z)(h,3),x=p[0],g=p[1],v=p[2];(0,i.useEffect)((function(){console.log(m),m&&v("")}),[m]);var j=(0,i.useCallback)((function(){n((0,l.BZ)(x))}),[x]),k=(0,i.useCallback)((function(){f.current.click()}),[f.current]);return(0,r.jsxs)(c.Z,{style:{margin:"10px 0 20px "},encType:"multipart/form-data",onFinish:j,children:[(0,r.jsx)(a.Z.TextArea,{value:x,onChange:g,maxLength:140,placeholder:"\ubb34\uc2a8 \uc77c\uc774 \uc788\uc5c8\ub098\uc694?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"file",multiple:!0,hidden:!0,ref:f}),(0,r.jsx)(d.Z,{onClick:k,children:"\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc"}),(0,r.jsx)(d.Z,{type:"primary",style:{float:"right"},htmlType:"submit",children:"\uc9f9\uc9f9"})]}),(0,r.jsx)("div",{children:t.map((function(n){d.Z}))})]})},f=t(27261),h=t(76040),p=t(19181),x=t(51890),g=t(41100),v=t(31990),j=t(20574),k=t(32769),E=t(57206),Z=t(75491),C=t(44545),P=t(29163),b=t(41664),A=t(49101),_=t(46066),S=t(54549);function y(){var n=(0,f.Z)(["\n  .slick-slide {\n    display: inline-block;\n  }\n  .ant-card-cover {\n    transform: none !important;\n  }\n"]);return y=function(){return n},n}function w(){var n=(0,f.Z)(["\n  padding: 32px;\n  text-align: center;\n  \n  & img {\n    margin: 0 auto;\n    max-height: 750px;\n  }\n"]);return w=function(){return n},n}function T(){var n=(0,f.Z)(["\n  text-align: center;\n  \n  & > div {\n    width: 75px;\n    height: 30px;\n    line-height: 30px;\n    border-radius: 15px;\n    background: #313131;\n    display: inline-block;\n    text-align: center;\n    color: white;\n    font-size: 15px;\n  }\n"]);return T=function(){return n},n}function L(){var n=(0,f.Z)(["\n  height: calc(100% - 44px);\n  background: #090909;\n"]);return L=function(){return n},n}function U(){var n=(0,f.Z)(["\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 15px;\n  line-height: 14px;\n  cursor: pointer;\n"]);return U=function(){return n},n}function O(){var n=(0,f.Z)(["\n  height: 44px;\n  background: white;\n  position: relative;\n  padding: 0;\n  text-align: center;\n  \n  & h1 {\n    margin: 0;\n    font-size: 17px;\n    color: #333;\n    line-height: 44px;\n  }\n"]);return O=function(){return n},n}function R(){var n=(0,f.Z)(["\n  position: fixed;\n  z-index: 5000;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n"]);return R=function(){return n},n}var D=P.ZP.div(R()),I=P.ZP.header(O()),M=(0,P.ZP)(S.Z)(U()),F=P.ZP.div(L()),N=P.ZP.div(T()),z=P.ZP.div(w()),Q=(0,P.vJ)(y()),V=function(n){var e=n.images,t=n.onClose,o=(0,i.useState)(0),s=o[0],c=o[1];return(0,r.jsxs)(D,{children:[(0,r.jsx)(Q,{})," ",(0,r.jsxs)(I,{children:[(0,r.jsx)("h1",{children:"\uc0c1\uc138 \uc774\ubbf8\uc9c0"}),(0,r.jsx)(M,{onClick:t,children:"X"})]}),(0,r.jsx)(F,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)(_.Z,{initialSlide:0,beforeChange:function(n){return c(n)},infinite:!0,arrows:!1,slidesToShow:1,slidesToScroll:1,children:e.map((function(n){return(0,r.jsx)(z,{children:(0,r.jsx)("img",{src:n.src,alt:n.src})},n.src)}))}),(0,r.jsx)(N,{children:(0,r.jsxs)("div",{children:[s+1," ","/",e.length]})})]})})]})},H=function(n){var e=n.images,t=(0,i.useState)(!1),o=t[0],s=t[1],c=(0,i.useCallback)((function(){return s(!0)}),[]),a=(0,i.useCallback)((function(){return s(!1)}),[]);return 1===e.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{role:"presentation",src:e[0].src,alt:e[0].src,onClick:c}),o&&(0,r.jsx)(V,{images:e,onClose:a})]}):2===e.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{role:"presentation",style:{overflow:"hidden",width:"50%",display:"inline-block"},src:e[0].src,alt:e[0].src,onClick:c}),(0,r.jsx)("img",{role:"presentation",style:{overflow:"hidden",width:"50%",display:"inline-block"},src:e[1].src,alt:e[1].src,onClick:c}),o&&(0,r.jsx)(V,{images:e,onClose:a})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{role:"presentation",style:{width:"50%"},src:e[1].src,alt:e[1].src,onClick:c,onLoad:measure}),(0,r.jsxs)("div",{role:"presentation",style:{display:"inline-block",width:"50%",textAlign:"center",verticalAlign:"middle"},onClick:c,children:[(0,r.jsx)(A.Z,{}),(0,r.jsx)("br",{}),e.length-1,"\uac1c\uc758 \uc0ac\uc9c4 \ub354\ubcf4\uae30"]})]}),o&&(0,r.jsx)(V,{images:e,onClose:a})]})},X=function(n){var e=n.post,t=(0,o.v9)((function(n){var e;return null===(e=n.user.me)||void 0===e?void 0:e.id})),m=(0,o.v9)((function(n){return n.post})),f=m.commentAdded,h=m.commentAdding,p=(0,o.I0)(),x=(0,u.Z)(""),g=(0,s.Z)(x,3),v=g[0],j=g[1],k=g[2];(0,i.useEffect)((function(){f&&k("")}),[f]);var E=(0,i.useCallback)((function(){p((0,l.Pc)({content:v,postId:e.id,userId:t}))}),[v,t]);return(0,r.jsx)(c.Z,{onFinish:E,children:(0,r.jsxs)(c.Z.Item,{children:[(0,r.jsx)(a.Z.TextArea,{value:v,onChange:j,rows:4}),(0,r.jsx)(d.Z,{type:"primary",htmlType:"submit",loading:h,children:"\uc090\uc57d"})]})})},B=function(n){var e=n.postData;return(0,r.jsx)("div",{children:e.split(/(#[^\s#]+)/g).map((function(n,e){return n.match(/(#[^\s#]+)/)?(0,r.jsx)(b.default,{href:"/hashtag/".concat(n.slice(1)),children:(0,r.jsx)("a",{children:n})},e):n}))})},G=t(76915);function Y(){var n=(0,f.Z)(["\n  margin-botton: 20px;\n"]);return Y=function(){return n},n}var q=P.ZP.div(Y()),J=function(n){var e=n.post,t=(0,o.v9)((function(n){var e;return null===(e=n.user.me)||void 0===e?void 0:e.id})),s=(0,o.I0)(),c=(0,o.v9)((function(n){return n.post})).postRemoving,a=(0,i.useState)(!1),u=a[0],m=a[1],f=(0,i.useState)(!1),P=f[0],A=f[1],_=(0,i.useCallback)((function(){m(!u)}),[u]),S=(0,i.useCallback)((function(){A((function(n){return!n}))}),[]),y=(0,i.useCallback)((function(n){console.log(n.current),s((0,l.VE)(e.id))}),[]);return(0,r.jsxs)(q,{children:[(0,r.jsx)(h.Z,{cover:e.Images[0]&&(0,r.jsx)(H,{images:e.Images}),actions:[(0,r.jsx)(j.Z,{},"retweet"),u?(0,r.jsx)(k.Z,{twoToneColor:"red",onClick:_},"heart"):(0,r.jsx)(E.Z,{onClick:_},"heart"),(0,r.jsx)(Z.Z,{onClick:S},"comment"),(0,r.jsx)(p.Z,{content:(0,r.jsx)(d.Z.Group,{children:t&&e.User.id===t?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{children:"\uc218\uc815"}),(0,r.jsx)(d.Z,{type:"danger",loading:c,onClick:y,children:"\uc0ad\uc81c"})]}):(0,r.jsx)(d.Z,{children:"\uc2e0\uace0"})}),children:(0,r.jsx)(C.Z,{})},"ellipsis")],children:(0,r.jsx)(h.Z.Meta,{avatar:(0,r.jsx)(x.C,{children:e.User.nickname[0]}),title:e.User.nickname,description:(0,r.jsx)(B,{postData:e.content})})}),P&&(0,r.jsxs)("div",{children:[(0,r.jsx)(X,{post:e}),(0,r.jsx)(g.ZP,{header:"".concat(e.Comments.length,"\uac1c\uc758 \ub313\uae00"),itemLayout:"horizontal",dataSource:e.Comments,renderItem:function(n){return(0,r.jsx)("li",{children:(0,r.jsx)(v.Z,{author:n.User.nickname,avatar:(0,r.jsx)(b.default,{href:{pathname:"/user",query:{id:n.User.id}},as:"/user/".concat(n.User.id),children:(0,r.jsx)("a",{children:(0,r.jsx)(x.C,{children:n.User.nickname[0]})})}),content:n.content})})}})]})]},e.id)},K=t(22471),W=function(){var n=(0,o.I0)(),e=(0,o.v9)((function(n){return n.user})).me,t=(0,o.v9)((function(n){return n.post})),s=t.mainPosts,c=t.hasMorePosts,a=t.postLoading;return(0,i.useEffect)((function(){n((0,G.Ho)()),n((0,l.Lz)())}),[]),(0,i.useEffect)((function(){function e(){window.scrollY+document.documentElement.clientHeight>document.documentElement.scrollHeight-300&&c&&!a&&n((0,l.Lz)())}return window.addEventListener("scroll",e),function(){window.removeEventListener("scroll",e)}}),[c,a]),(0,r.jsxs)(K.Z,{children:[e&&(0,r.jsx)(m,{}),s.map((function(n){return(0,r.jsx)(J,{post:n},n.id)}))]})}},96598:function(n,e,t){"use strict";t.d(e,{nk:function(){return d},EG:function(){return u},YQ:function(){return l},rl:function(){return m},z9:function(){return f},_s:function(){return h},tP:function(){return p},HU:function(){return x},rK:function(){return g},Ws:function(){return v},Ot:function(){return j},nv:function(){return k},rX:function(){return E},Lz:function(){return Z},BZ:function(){return C},Pc:function(){return P},VE:function(){return b}});var r=t(14670),i=t.n(r),o=t(18172),s=t(85384),c=t.n(s),a={mainPosts:[],imagePaths:[],hasMorePosts:!0,postLoading:!1,postLoaded:!1,postAdding:!1,postAdded:!1,postRemoving:!1,postRemoved:!1,commentAdding:!1,commentAdded:!1,actionError:null},d=function(n){return Array(n).fill().map((function(){return{id:i().generate(),User:{id:i().generate(),nickname:c().name.findName()},content:c().lorem.paragraph(),Images:[{src:c().image.image()}],Comments:[{User:{id:i().generate(),nickname:c().name.findName()},content:c().lorem.sentence()}]}}))},u="LOAD_POST_REQUEST",l="LOAD_POST_SUCCESS",m="LOAD_POST_FAILURE",f="ADD_POST_REQUEST",h="ADD_POST_SUCCESS",p="ADD_POST_FAILURE",x="REMOVE_POST_REQUEST",g="REMOVE_POST_SUCCESS",v="REMOVE_POST_FAILURE",j="ADD_COMMENT_REQUEST",k="ADD_COMMENT_SUCCESS",E="ADD_COMMENT_FAILURE",Z=function(n){return{type:u,data:n}},C=function(n){return{type:f,data:n}},P=function(n){return{type:j,data:n}},b=function(n){return{type:x,data:n}};e.ZP=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,e=arguments.length>1?arguments[1]:void 0;return(0,o.ZP)(n,(function(n){switch(e.type){case u:n.postLoading=!0,n.postLoadded=!1,n.actionError=null;break;case l:n.postLoading=!1,n.postLoadded=!0,n.mainPosts=n.mainPosts.concat(e.data),n.hasMorePosts=n.mainPosts.length<50;break;case m:n.postLoading=!1,n.postLoadded=!1,n.actionError=e.error;break;case f:n.postAdding=!0,n.postAdded=!1,n.actionError=null;break;case h:n.postAdding=!1,n.postAdded=!0,n.mainPosts.unshift(e.data);break;case p:n.postAdding=!1,n.postAdded=!1,n.actionError=e.error;break;case x:n.postRemoving=!0,n.postRemoved=!1,n.actionError=null;break;case g:n.postRemoving=!1,n.postRemoved=!0,n.mainPosts=n.mainPosts.filter((function(n){return n.id!==e.data}));break;case v:n.postRemoving=!1,n.postRemoved=!1,n.actionError=e.arror;break;case j:n.commentAdding=!0,n.commentAdded=!1,n.actionError=null;break;case k:n.commentAdding=!1,n.commentAdded=!0,n.mainPosts.find((function(n){return n.id===e.data.PostId})).Comments.unshift(e.data);break;case E:n.commentAdding=!1,n.commentAdded=!1,n.actionError=e.error}}))}},78581:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(65778)}])}},function(n){n.O(0,[774,43,351,96,610,794,100,389,471],(function(){return e=78581,n(n.s=e);var e}));var e=n.O();_N_E=e}]);