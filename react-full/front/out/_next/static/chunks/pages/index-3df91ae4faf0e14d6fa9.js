(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{65778:function(n,t,e){"use strict";e.r(t),e.d(t,{__N_SSP:function(){return $},default:function(){return nn}});var r=e(85893),i=e(67294),o=e(94654),a=e(39227),s=e(86396),c=e(25779),d=e(18222),u=e(90169),l=e(96598),f=function(){var n=(0,o.I0)(),t=(0,o.v9)((function(n){return n.post})),e=t.imagePaths,f=t.postAdded,h=(0,i.useRef)(),p=(0,u.Z)(""),m=(0,a.Z)(p,3),g=m[0],x=m[1],E=m[2];(0,i.useEffect)((function(){f&&E("")}),[f]);var k=(0,i.useCallback)((function(){if(!g||!g.trim())return alert("\uac8c\uc2dc\uae00\uc744 \uc791\uc131\ud558\uc138\uc694.");var t=new FormData;return e.forEach((function(n){t.append("image",n)})),t.append("content",g),n((0,l.BZ)(t))}),[g,e]),v=(0,i.useCallback)((function(){h.current.click()}),[h.current]),j=(0,i.useCallback)((function(t){return function(){n({type:l.Po,data:t})}})),L=(0,i.useCallback)((function(t){console.log("images",t.target.files);var e=new FormData;[].forEach.call(t.target.files,(function(n){e.append("image",n)})),n({type:l.QA,data:e})}),[]);return(0,r.jsxs)(s.Z,{style:{margin:"10px 0 20px "},encType:"multipart/form-data",onFinish:k,children:[(0,r.jsx)(c.Z.TextArea,{value:g,onChange:x,maxLength:140,placeholder:"\ubb34\uc2a8 \uc77c\uc774 \uc788\uc5c8\ub098\uc694?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"file",name:"image",multiple:!0,hidden:!0,ref:h,onChange:L}),(0,r.jsx)(d.Z,{onClick:v,children:"\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc"}),(0,r.jsx)(d.Z,{type:"primary",style:{float:"right"},htmlType:"submit",children:"\uc9f9\uc9f9"})]}),(0,r.jsx)("div",{children:e.map((function(n,t){return(0,r.jsxs)("div",{style:{display:"inline-block"},children:[(0,r.jsx)("img",{src:"http://localhost:3065/".concat(n),style:{width:"200px"},alt:n}),(0,r.jsx)("div",{children:(0,r.jsx)(d.Z,{onClick:j(t),children:"\uc81c\uac70"})})]},n)}))})]})},h=e(27261),p=e(76040),m=e(19181),g=e(51890),x=e(41100),E=e(31990),k=e(20574),v=e(32769),j=e(57206),L=e(75491),C=e(44545),_=e(29163),S=e(41664),P=e(49101),b=e(46066),U=e(54549);function Z(){var n=(0,h.Z)(["\n  .slick-slide {\n    display: inline-block;\n  }\n  .ant-card-cover {\n    transform: none !important;\n  }\n"]);return Z=function(){return n},n}function A(){var n=(0,h.Z)(["\n  padding: 32px;\n  text-align: center;\n  \n  & img {\n    margin: 0 auto;\n    max-height: 750px;\n  }\n"]);return A=function(){return n},n}function w(){var n=(0,h.Z)(["\n  text-align: center;\n  \n  & > div {\n    width: 75px;\n    height: 30px;\n    line-height: 30px;\n    border-radius: 15px;\n    background: #313131;\n    display: inline-block;\n    text-align: center;\n    color: white;\n    font-size: 15px;\n  }\n"]);return w=function(){return n},n}function T(){var n=(0,h.Z)(["\n  height: calc(100% - 44px);\n  background: #090909;\n"]);return T=function(){return n},n}function I(){var n=(0,h.Z)(["\n  position: absolute;\n  right: 0;\n  top: 0;\n  padding: 15px;\n  line-height: 14px;\n  cursor: pointer;\n"]);return I=function(){return n},n}function R(){var n=(0,h.Z)(["\n  height: 44px;\n  background: white;\n  position: relative;\n  padding: 0;\n  text-align: center;\n  \n  & h1 {\n    margin: 0;\n    font-size: 17px;\n    color: #333;\n    line-height: 44px;\n  }\n"]);return R=function(){return n},n}function y(){var n=(0,h.Z)(["\n  position: fixed;\n  z-index: 5000;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n"]);return y=function(){return n},n}var O=_.ZP.div(y()),D=_.ZP.header(R()),M=(0,_.ZP)(U.Z)(I()),F=_.ZP.div(T()),N=_.ZP.div(w()),Q=_.ZP.div(A()),G=(0,_.vJ)(Z()),K=function(n){var t=n.images,e=n.onClose,o=(0,i.useState)(0),a=o[0],s=o[1];return(0,r.jsxs)(O,{children:[(0,r.jsx)(G,{})," ",(0,r.jsxs)(D,{children:[(0,r.jsx)("h1",{children:"\uc0c1\uc138 \uc774\ubbf8\uc9c0"}),(0,r.jsx)(M,{onClick:e,children:"X"})]}),(0,r.jsx)(F,{children:(0,r.jsxs)("div",{children:[(0,r.jsx)(b.Z,{initialSlide:0,beforeChange:function(n){return s(n)},infinite:!0,arrows:!1,slidesToShow:1,slidesToScroll:1,children:t.map((function(n){return(0,r.jsx)(Q,{children:(0,r.jsx)("img",{src:"http://localhost:3065/".concat(n.src),alt:"http://localhost:3065/".concat(n.src)})},n.src)}))}),(0,r.jsx)(N,{children:(0,r.jsxs)("div",{children:[a+1," ","/",t.length]})})]})})]})},V=function(n){var t=n.images,e=(0,i.useState)(!1),o=e[0],a=e[1],s=(0,i.useCallback)((function(){return a(!0)}),[]),c=(0,i.useCallback)((function(){return a(!1)}),[]);return 1===t.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{role:"presentation",src:"http://localhost:3065/".concat(t[0].src),alt:"http://localhost:3065/".concat(t[0].src),onClick:s}),o&&(0,r.jsx)(K,{images:t,onClose:c})]}):2===t.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{role:"presentation",style:{overflow:"hidden",width:"50%",display:"inline-block"},src:"http://localhost:3065/".concat(t[0].src),alt:"http://localhost:3065/".concat(t[0].src),onClick:s}),(0,r.jsx)("img",{role:"presentation",style:{overflow:"hidden",width:"50%",display:"inline-block"},src:"http://localhost:3065/".concat(t[1].src),alt:"http://localhost:3065/".concat(t[1].src),onClick:s}),o&&(0,r.jsx)(K,{images:t,onClose:c})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("img",{role:"presentation",style:{width:"50%"},src:"http://localhost:3065/".concat(t[0].src),alt:"http://localhost:3065/".concat(t[0].src),onClick:s}),(0,r.jsxs)("div",{role:"presentation",style:{display:"inline-block",width:"50%",textAlign:"center",verticalAlign:"middle"},onClick:s,children:[(0,r.jsx)(P.Z,{}),(0,r.jsx)("br",{}),t.length-1,"\uac1c\uc758 \uc0ac\uc9c4 \ub354\ubcf4\uae30"]})]}),o&&(0,r.jsx)(K,{images:t,onClose:c})]})},z=function(n){var t=n.post,e=(0,o.v9)((function(n){var t;return null===(t=n.user.me)||void 0===t?void 0:t.id})),f=(0,o.v9)((function(n){return n.post})),h=f.commentAdded,p=f.commentAdding,m=f.actionError,g=(0,o.I0)(),x=(0,u.Z)(""),E=(0,a.Z)(x,3),k=E[0],v=E[1],j=E[2];(0,i.useEffect)((function(){m&&alert(m)}),[m]),(0,i.useEffect)((function(){h&&j("")}),[h]);var L=(0,i.useCallback)((function(){g((0,l.Pc)({content:k,postId:t.id,userId:e}))}),[k,e]);return(0,r.jsx)(s.Z,{onFinish:L,children:(0,r.jsxs)(s.Z.Item,{children:[(0,r.jsx)(c.Z.TextArea,{value:k,onChange:v,rows:4}),(0,r.jsx)(d.Z,{type:"primary",htmlType:"submit",loading:p,children:"\uc090\uc57d"})]})})},X=function(n){var t=n.postData;return(0,r.jsx)("div",{children:t.split(/(#[^\s#]+)/g).map((function(n,t){return n.match(/(#[^\s#]+)/)?(0,r.jsx)(S.default,{href:"/hashtag/".concat(n.slice(1)),children:(0,r.jsx)("a",{children:n})},t):n}))})},W=e(76915),H=function(n){var t=n.post,e=(0,o.I0)(),a=(0,o.v9)((function(n){return n.user})),s=a.me,c=a.isFollowing,u=a.isUnFollowing,l=null===s||void 0===s?void 0:s.Followings.find((function(n){return n.id===t.User.id})),f=(0,i.useCallback)((function(){e(l?(0,W.Cm)(t.User.id):(0,W.s6)(t.User.id))}),[l]);return t.User.id===s.id?null:(0,r.jsx)(d.Z,{loading:c||u,onClick:f,children:l?"\uc5b8\ud314\ub85c\uc6b0":"\ud314\ub85c\uc6b0"})};function q(){var n=(0,h.Z)(["\nmargin-botton: 20px;\n"]);return q=function(){return n},n}var B=_.ZP.div(q()),Y=function(n){var t=n.post,e=(0,o.I0)(),a=(0,o.v9)((function(n){return n.post})),s=a.postRemoving,c=(a.actionError,(0,o.v9)((function(n){return n.user})).me,(0,i.useState)(!1)),u=c[0],f=c[1],h=(0,o.v9)((function(n){var t;return null===(t=n.user.me)||void 0===t?void 0:t.id})),_=(0,i.useCallback)((function(){if(!h)return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");e({type:l.xD,data:t.id})}),[]),P=(0,i.useCallback)((function(){if(!h)return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");e({type:l.VT,data:t.id})}),[]),b=(0,i.useCallback)((function(){if(!h)return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");f((function(n){return!n}))}),[]),U=(0,i.useCallback)((function(n){if(!h)return alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.");console.log(n.current),e((0,l.VE)(t.id))}),[]),Z=(0,i.useCallback)((function(){return h?e({type:l.a0,data:t.id}):alert("\ub85c\uadf8\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4.")}),[h]),A=t.Likers.find((function(n){return n.id===h}));return(0,r.jsxs)(B,{children:[(0,r.jsx)(p.Z,{cover:t.Images[0]&&(0,r.jsx)(V,{images:t.Images}),actions:[(0,r.jsx)(k.Z,{onClick:Z},"retweet"),A?(0,r.jsx)(v.Z,{twoToneColor:"red",onClick:P},"heart"):(0,r.jsx)(j.Z,{onClick:_},"heart"),(0,r.jsx)(L.Z,{onClick:b},"comment"),(0,r.jsx)(m.Z,{content:(0,r.jsx)(d.Z.Group,{children:h&&t.User.id===h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Z,{children:"\uc218\uc815"}),(0,r.jsx)(d.Z,{type:"danger",loading:s,onClick:U,children:"\uc0ad\uc81c"})]}):(0,r.jsx)(d.Z,{children:"\uc2e0\uace0"})}),children:(0,r.jsx)(C.Z,{})},"ellipsis")],title:t.RetweetId?"".concat(t.User.nickname,"\ub2d8\uc774 \ub9ac\ud2b8\uc717\ud558\uc168\uc2b5\ub2c8\ub2e4."):null,extra:h&&(0,r.jsx)(H,{post:t}),children:t.RetweetId&&t.Retweet?(0,r.jsx)(p.Z,{cover:t.Retweet.Images[0]&&(0,r.jsx)(V,{images:t.Retweet.Images}),children:(0,r.jsx)(p.Z.Meta,{avatar:(0,r.jsx)(g.C,{children:t.User.nickname[0]}),title:t.Retweet.User.nickname,description:(0,r.jsx)(X,{postData:t.Retweet.content})})}):(0,r.jsx)(p.Z.Meta,{avatar:(0,r.jsx)(g.C,{children:t.User.nickname[0]}),title:t.User.nickname,description:(0,r.jsx)(X,{postData:t.content})})}),u&&(0,r.jsxs)("div",{children:[(0,r.jsx)(z,{post:t}),(0,r.jsx)(x.ZP,{header:"".concat(t.Comments.length,"\uac1c\uc758 \ub313\uae00"),itemLayout:"horizontal",dataSource:t.Comments,renderItem:function(n){return(0,r.jsx)("li",{children:(0,r.jsx)(E.Z,{author:n.User.nickname,avatar:(0,r.jsx)(S.default,{href:{pathname:"/user",query:{id:n.User.id}},as:"/user/".concat(n.User.id),children:(0,r.jsx)("a",{children:(0,r.jsx)(g.C,{children:n.User.nickname[0]})})}),content:n.content})})}})]})]},t.id)},J=e(22471),$=!0,nn=function(){var n=(0,o.I0)(),t=(0,o.v9)((function(n){return n.user})).me,e=(0,o.v9)((function(n){return n.post})),a=e.mainPosts,s=e.hasMorePosts,c=e.postLoading,d=e.actionError;return(0,i.useEffect)((function(){d&&alert(d)}),[d]),(0,i.useEffect)((function(){function t(){if(window.scrollY+document.documentElement.clientHeight>document.documentElement.scrollHeight-300&&s&&!c){var t,e=null===(t=a[a.length-1])||void 0===t?void 0:t.id;console.log(e),n({type:l.EG,lastId:e})}}return window.addEventListener("scroll",t),function(){window.removeEventListener("scroll",t)}}),[s,c,a]),(0,r.jsxs)(J.Z,{children:[t&&(0,r.jsx)(f,{}),a.map((function(n){return(0,r.jsx)(Y,{post:n},n.id)}))]})}},96598:function(n,t,e){"use strict";e.d(t,{QA:function(){return o},kv:function(){return a},hX:function(){return s},Po:function(){return c},EG:function(){return d},YQ:function(){return u},rl:function(){return l},z9:function(){return f},_s:function(){return h},tP:function(){return p},HU:function(){return m},rK:function(){return g},Ws:function(){return x},xD:function(){return E},Gz:function(){return k},cT:function(){return v},VT:function(){return j},XD:function(){return L},gq:function(){return C},Ot:function(){return _},nv:function(){return S},rX:function(){return P},a0:function(){return b},ZL:function(){return U},FM:function(){return Z},WK:function(){return A},BZ:function(){return w},Pc:function(){return T},VE:function(){return I}});var r=e(18172),i={mainPosts:[],imagePaths:[],retweetLoading:!1,retweetLoaded:!1,hasMorePosts:!0,imagesLoding:!1,imagesLoaded:!1,postLoading:!1,postLoaded:!1,postAdding:!1,postAdded:!1,postRemoving:!1,postRemoved:!1,postLiking:!1,postLiked:!1,postUnLiking:!1,postUnLiked:!1,commentAdding:!1,commentAdded:!1,actionError:null,reset:!1,test:[]},o="UPLOAD_IMAGES_REQUEST",a="UPLOAD_IMAGES_SUCCESS",s="UPLOAD_IMAGES_FAILURE",c="REMOVE_IMAGE",d="LOAD_POST_REQUEST",u="LOAD_POST_SUCCESS",l="LOAD_POST_FAILURE",f="ADD_POST_REQUEST",h="ADD_POST_SUCCESS",p="ADD_POST_FAILURE",m="REMOVE_POST_REQUEST",g="REMOVE_POST_SUCCESS",x="REMOVE_POST_FAILURE",E="LIKE_POST_REQUEST",k="LIKE_POST_SUCCESS",v="LIKE_POST_FAILURE",j="UNLIKE_POST_REQUEST",L="UNLIKE_POST_SUCCESS",C="UNLIKE_POST_FAILURE",_="ADD_COMMENT_REQUEST",S="ADD_COMMENT_SUCCESS",P="ADD_COMMENT_FAILURE",b="RETWEET_REQUEST",U="RETWEET_SUCCESS",Z="RETWEET_FAILURE",A="RESET_MAIN_POST",w=function(n){return{type:f,data:n}},T=function(n){return{type:_,data:n}},I=function(n){return{type:m,data:n}};t.ZP=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;return(0,r.ZP)(n,(function(n){switch(t.type){case c:n.imagePaths=n.imagePaths.filter((function(n,e){return e!==t.data}));break;case b:n.retweetLoading=!0,n.retweetLoaded=!1,n.actionError=null;break;case U:n.retweetLoading=!1,n.retweetLoaded=!0,n.mainPosts.unshift(t.data);break;case Z:n.retweetLoading=!1,n.retweetLoaded=!1,n.actionError=t.error;break;case o:n.imagesLoding=!0,n.imagesLoadded=!1,n.actionError=null;break;case a:n.imagesLoding=!1,n.imagesLoadded=!0,n.imagePaths=t.data;break;case s:n.imagesLoding=!1,n.imagesLoadded=!1,n.actionError=t.error;break;case d:n.postLoading=!0,n.postLoadded=!1,n.actionError=null;break;case u:n.postLoading=!1,n.postLoadded=!0,n.mainPosts=n.mainPosts.concat(t.data),n.hasMorePosts=10===t.data.length;break;case l:n.postLoading=!1,n.postLoadded=!1,n.actionError=t.error;break;case f:n.postAdding=!0,n.postAdded=!1,n.actionError=null;break;case h:n.postAdding=!1,n.postAdded=!0,n.mainPosts.unshift(t.data),n.imagePaths=[];break;case p:n.postAdding=!1,n.postAdded=!1,n.actionError=t.error;break;case m:n.postRemoving=!0,n.postRemoved=!1,n.actionError=null;break;case g:n.postRemoving=!1,n.postRemoved=!0,n.mainPosts=n.mainPosts.filter((function(n){return n.id!==t.data.PostId}));break;case x:n.postRemoving=!1,n.postRemoved=!1,n.actionError=t.arror;break;case E:n.postLiking=!0,n.postLiked=!1,n.actionError=null;break;case k:n.mainPosts.find((function(n){return n.id===parseInt(t.data.postId,10)})).Likers.push({id:t.data.UserId}),n.postLiking=!1,n.postLiked=!0;break;case v:n.postLiking=!1,n.postLiked=!1,n.actionError=t.arror;break;case j:n.postUnLiking=!0,n.postUnLiked=!1,n.actionError=null;break;case L:var e=n.mainPosts.find((function(n){return n.id===parseInt(t.data.postId,10)}));e.Likers=e.Likers.filter((function(n){return n.id!==t.data.UserId})),n.postUnLiking=!1,n.postUnLiked=!0;break;case C:n.postUnLiking=!1,n.postUnLiked=!1,n.actionError=t.arror;break;case _:n.commentAdding=!0,n.commentAdded=!1,n.actionError=null;break;case S:n.mainPosts.find((function(n){return n.id===t.data.PostId})).Comments.unshift(t.data),n.commentAdding=!1,n.commentAdded=!0;break;case P:n.commentAdding=!1,n.commentAdded=!1,n.actionError=t.error;break;case A:n.reset=!0,n.mainPosts=[]}}))}},78581:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return e(65778)}])}},function(n){n.O(0,[774,351,703,610,100,816,471],(function(){return t=78581,n(n.s=t);var t}));var t=n.O();_N_E=t}]);